---
import BaseLayout from "../layouts/BaseLayout.astro";
import SectionCard from "../components/SectionCard.astro";
import BackButton from "../components/BackButton.astro";
import metadata from "../assets/metadata.json";

const bibliographyHtml: string = (metadata as any)?.methods_description?.tool_bibliography || "";
const contributors: any[] = (metadata as any)?.methods_description?.manifest_map?.contributors || [];
---

<BaseLayout title="Citations - nf-core/tfactivity report" active="citations">
  <div class="max-w-4xl mx-auto px-4 py-6">
        <h1 class="text-3xl font-bold text-gray-800 mb-6 text-center">Citations</h1>
        <p class="text-gray-600 text-center mb-8">Please cite the following tools and resources used in this analysis.</p>

        <!-- Contributors -->
        <SectionCard title="Contributors">
          <div>
            {contributors.length === 0 ? (
              <p class="text-gray-600">No contributor information available.</p>
            ) : (
              <ul class="space-y-4">
                {contributors.map((c: any) => (
                  <li class="border border-gray-100 rounded-md p-4">
                    <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between">
                      <div>
                        <div class="text-lg font-semibold text-gray-900">{c.name}</div>
                        {c.affiliation && (
                          <div class="text-gray-600">{c.affiliation}</div>
                        )}
                        {Array.isArray(c.contribution) && c.contribution.length > 0 && (
                          <div class="mt-1">
                            <span class="text-xs uppercase tracking-wide text-gray-500">Roles:</span>
                            <span class="ml-2 text-sm text-gray-700">{c.contribution.join(", ")}</span>
                          </div>
                        )}
                      </div>
                      <div class="mt-3 sm:mt-0 flex flex-wrap items-center gap-3">
                        {c.orcid && (
                          <a href={`https://orcid.org/${c.orcid}`} target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:text-blue-800 text-sm underline">ORCID</a>
                        )}
                        {c.github && (
                          <a href={`https://github.com/${c.github}`} target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:text-blue-800 text-sm underline">GitHub</a>
                        )}
                        {c.email && (
                          <a href={`mailto:${c.email}`} class="text-blue-600 hover:text-blue-800 text-sm underline">Email</a>
                        )}
                      </div>
                    </div>
                  </li>
                ))}
              </ul>
            )}
          </div>
        </SectionCard>

        <SectionCard title="Bibliography">
          <ul class="list-disc list-outside pl-6 space-y-2">
              <Fragment set:html={bibliographyHtml} />
            </ul>
        </SectionCard>

        <!-- Back to Rankings Button -->
        <div class="mt-12 text-center">
          <BackButton />
        </div>
  </div>
</BaseLayout>

